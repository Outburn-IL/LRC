<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type"/>
    <title>DataFlow - Hospital-Community Lab Referral Cycle v0.1.0</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link href="fhir.css" rel="stylesheet"/>

    <!-- Bootstrap core CSS -->
    <link href="assets/css/bootstrap-fhir.css" rel="stylesheet"/>

    <!-- Project extras -->
    <link href="assets/css/project.css" rel="stylesheet"/>
    <link href="assets/css/pygments-manni.css" rel="stylesheet"/>
    <link href="assets/css/jquery-ui.css" rel="stylesheet"/>
  	<link href="assets/css/prism.css" rel="stylesheet" />
    <!-- Placeholder for child template CSS declarations -->
<link href="assets/css/rtl-fixes.css" rel="stylesheet"/>


    <script type="text/javascript" src="fhir-table-scripts.js"> </script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif]-->

    <!-- Favicons -->
    <link rel="fhir-logo" sizes="144x144" href="assets/ico/icon-fhir-144.png"/>
    <link rel="fhir-logo" sizes="114x114" href="assets/ico/icon-fhir-114.png"/>
    <link rel="fhir-logo" sizes="72x72" href="assets/ico/icon-fhir-72.png"/>
    <link rel="fhir-logo" href="assets/ico/icon-fhir-57.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body onload="document.body.style.opacity='1'">

	  <script src="assets/js/prism.js"></script>

    <style type="text/css">h2{--heading-prefix:"2"}
    h3,h4,h5,h6{--heading-prefix:"2"}</style>
    <div id="segment-header" class="segment">  <!-- segment-header -->
      <div class="container">  <!-- container -->
        <!-- Placeholder for child template header declarations -->


        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">Hospital-Community Lab Referral Cycle</span>
            <br/>
            <span style="display:inline-block;">0.1.0 - ci-build


            </span>
          </p>
        </div>
      </div> <!-- /container -->
    </div>  <!-- /segment-header -->

    <div id="segment-navbar" class="segment">  <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">  <!-- container -->
        <!-- HEADER CONTENT -->

        <nav class="navbar navbar-inverse">
          <!--status-bar-->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" class="navbar-toggle" data-toggle="collapse" type="button">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a class="navbar-brand hidden" href="http://hl7.org/fhir/R4/index.html">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <!-- menu.xml  -->

<ul xmlns="http://www.w3.org/1999/xhtml" class="nav navbar-nav">
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">קישורים נוספים
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a target="_blank" href="http://hl7.org/fhir/R4/index.html">FHIR Spec</a>
      </li>
      <li>
        <a target="_blank" href="https://en.fhir-il-community.org/fhir-israel-core">Israel LCore</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="downloads.html">הורדות</a>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">משאבי FHIR
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="profiles-and-extensions.html">פרופילים והרחבות</a>
      </li>
      <li>
        <a href="examples.html">דוגמאות</a>
      </li>
    </ul>
  </li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">הנחיות
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="search-interactions.html">חיפושים ואינטראקציות</a>
      </li>
      <li>
        <a href="server-community.html">server - קהילה</a>
      </li>
      <li>
        <a href="server-hospital.html">server - בית החולים</a>
      </li>
      <li>
        <a href="client-hospital.html">client - בית החולים</a>
      </li>
    </ul>
  </li>
  <li>
    <a href="data-flow.html">Dataflow</a>
  </li>
  <li>
    <a href="index.html">בית</a>
  </li>
</ul>
            </div>  <!-- /.nav-collapse -->
          </div>  <!-- /.container -->
        </nav>  <!-- /.navbar -->
      <!-- /HEADER CONTENT -->
      </div>  <!-- /container -->
    </div>  <!-- /segment-navbar -->
    <!--status-bar-->

    <div id="segment-breadcrumb" class="segment">  <!-- segment-breadcrumb -->
      <div class="container">  <!-- container -->
        <ul class="breadcrumb">
          <li><a href='toc.html'><b>Table of Contents</b></a></li><li><b>DataFlow</b></li>

        </ul>
      </div>  <!-- /container -->
    </div>  <!-- /segment-breadcrumb -->

    <a name="top"> </a>
    <div id="segment-content" class="segment">  <!-- segment-content -->
      <div class="container">  <!-- container -->
        <div class="row">
          <div class="inner-wrapper">

<style type="text/css">
h2:before{color:silver;counter-increment:section;content:var(--heading-prefix) " ";}
h3:before{color:silver;counter-increment:sub-section;content:var(--heading-prefix) "." counter(sub-section) " ";}
h4:before{color:silver;counter-increment:composite;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) " ";}
h5:before{color:silver;counter-increment:detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) " ";}
h6:before{color:silver;counter-increment:more-detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) "." counter(more-detail)" ";}
</style>
<div class="col-12">
  <!--ReleaseHeader--><p id="publish-box">Hospital-Community Lab Referral Cycle - Local Development build (v0.1.0) built by the FHIR (HL7® FHIR® Standard) Build Tools. See the <a href="http://oncology.fhir.outburn.co.il/history.html">Directory of published versions</a></p><!--EndReleaseHeader-->
  <h2>DataFlow</h2>
  












    <p><!-- white space is critical inside of capture --></p>
<div class="markdown-toc">
<ul id="markdown-toc">
  <li><a href="#section" id="markdown-toc-section">תרשים</a></li>
  <li><a href="#section-1" id="markdown-toc-section-1">הסבר נלווה לתרשים</a></li>
  <li><a href="#section-2" id="markdown-toc-section-2">טבלת סטאטוסים</a></li>
</ul>

</div>
<div dir="rtl">

  <p>בכדי להבין את התהליך וזרימת המידע, יש להתייחס להנחת יסוד חשובה ובסיסית בנוגע לחלוקה בין Client ו- Server בפרוייקט זה.
בתהליך משתתפים שני ארגונים, הארגון היוזם - בי”ח והארגון המבצע את הבדיקות - קהילה, כאשר לאורך שלבי התהליך משתנות ההגדרות של: מי מייצג את צד השרת (Server) ומי מייצג את צד הקליינט (Client).</p>

  <h3 id="section">תרשים</h3>

  <p>להלן תרשים של ה- flow, בהתייחס לאינטראקציות, לפרופילים ולמשאבים, בחלוקה של Client/Server</p>

  <p><img src="./LRC_Technical_flow.pdf" alt="LRC - Technical flow" /></p>

  <h3 id="section-1">הסבר נלווה לתרשים</h3>

  <p>התרשים מתייחס להעברת מידע של הפניות ותוצאות בדיקות מעבדה בין בי”ח לקהילה. 
לצורך הבנת התרשים יש להתייחס ל:
- צד שמאל מייצג את ביה”ח, וצד ימין מייצג את הקהילה. בכל אחד מהם ישנה חלוקה ל- Client/Server</p>

  <p>- מלבנים כתומים – מציינים את האינטראקציה: מתודה, סוג המשאב ושם הפרופיל.</p>

  <p>- מלבנים לבנים – תהליך פנימי, מידע חוזר בתגובה לשאילתה.</p>

  <p>- קו הפרדה צהוב - מפריד בין מקבץ אינטראקציות אשר בד”כ קשורות אחת לשניה. ההפרדה הינה לצורך קריאה ברורה של התהליך, אך יתכן שפעולה מסויימת תתבצע בסדר כרונולוגי שונה, למשל עדכון DiagnosticReport יתכן בכל שלב בתהליך (לאחר יצירתו).</p>

  <p>- מיספור השלבים נועד להתייחסות נוחה בהסברים עבור כל שלב.</p>

  <p>שלבי התהליך:</p>

  <ol>
    <li>GET Patient – ביה”ח מתשאל את הקהילה, לקבלת פרטי המטופל.</li>
    <li>אם המטופל קיים בשרת של הקהילה, יוחזר Bundle מסוג searchset עם משאב המטופל</li>
    <li>אם המטופל לא נמצא בשרת של הקהילה, יוחזר Bundle מסוג searchset ריק (ללא entry, ועם total=0).</li>
    <li>POST ServiceRequest - ביה”ח שולח לקהילה את פרטי ההפניה, כל הפניה בנפרד.
ההפניות נוצרות בפועל בשרת הקהילה רק לאחר מימוש המתודה עבור ההפניה המאגדת, כפי שמתואר בסעיף הבא.</li>
    <li>POST ServiceRequest - בסיום שליחת ההפניות לבדיקות מעבדה, ביה”ח שולח הפניה מאגדת, עם references לכל ההפניות שנשלחו עד כה. 
זהו הטריגר ליצירת ההפניות האטומיות/סוללות וליצירת ההפניה המאגדת בשרת הקהילה.</li>
  </ol>

  <ul>
    <li>המתודות של סעיפים 4 ו-5 אמנם זהות, אבל לכל אחת מהן מוגדר פרופיל ייעודי, והן מתקיימות על פי סדר כרונולוגי. תחילה נשלחות כל ההפניות האטומיות/סוללה, ורק בסיומן נשלחת ההפניה המאגדת (בניגוד לסעיף 8, למשל, בו אין תלות בסדר הכרונולוגי של השליחה).</li>
  </ul>

  <ol>
    <li>POST DiagnosticReport – לאחר שהתקבלה ההפניה המאגדת, הקהילה שולחת לביה”ח פקודה ליצירת דוח מסכם, כאשר הסטאטוס שלו מוגדר כ- registered (זאת בהנחה שהתהליך התבצע באופן תקין. לפרטים נוספים אודות סטאטוסים- ר’ פרק “Status”). הדוח המסכם, בשלב זה, אינו כולל עדיין תוצאות.
שליחת הדוח כ- registered הוגדרה משתי סיבות: (1) זהו אישור לביה”ח שהטיפול בהפניה החל. 
(2) באופן זה מועבר המזהה של הדוח, אשר ישמש לצורך מעקב אחר סטאטוס התוצאות.</li>
    <li>POST Observation – שליחת התוצאות של בדיקות המעבדה מהקהילה לביה”ח.
שלב זה כולל גם את התוצאות האטומיות וגם את תוצאות הסוללה, מכיוון שאין סדר כרונולוגי ביניהן. כל התוצאות ומשאבי הסוללות נשלחים ללא הפרדה או סדר מחייב.</li>
    <li>PUT Observation – במידת הצורך, ניתן לעדכן תוצאות קיימות.
מומלץ לבצע את העדכון בעזרת conditional update, ובכך לבצע עדכון על פי מזהה עסקי, ולא לפי המזהה הלוגי.
רלוונטי גם לתוצאות האטומיות וגם לסוללת התוצאות.</li>
    <li>PUT/POST ServiceRequest – לצורך שלמות הנתונים בשרת ביה”ח, ובכדי לאפשר לביה”ח ליצור דוח מסכם מלא עם references מקומיים להפניה המאגדת ולכל ההפניות האטומיות, הקהילה שולחת פקודת יצירה עבור כל הפניה מהתהליך.
POST – ליצירת ההפניה.
PUT – לעדכון ההפניה. מומלץ לבצע את העדכון בעזרת conditional update, ובכך לבצע עדכון על פי מזהה עסקי, ולא לפי המזהה הלוגי.</li>
    <li>PUT DiagnosticReport – עדכון הדוח המסכם עם כל התוכן הרלוונטי (קישורים לתוצאות, קישורים להפניות, מסמך PDF).
   גם פה מומלץ להשתמש ב- conditional update מאותן הסיבות שתוארו בסעיפים הקודמים.</li>
  </ol>

  <h3 id="section-2">טבלת סטאטוסים</h3>

  <p>האלמנט status הינו אלמנט עם קארדינליות מסוג 1..1, כלומר שהוא מוגדר כחובה בשלושת המשאבים בתהליך זה (ServiceRequest, Observation, DiagnosticReport).
ישנה חשיבות גבוהה להתייחסות לסוגי הסטאטוסים השונים לאורך התהליך.</p>

  <p>להלן טבלה מרכזת עבור כל הסטאטוסים המעורבים בתהליך בחלוקה ל- Resources הרלוונטיים:</p>

  <table><tr><th colspan="1" valign="bottom"><b>Resource</b></th><th colspan="1" valign="bottom"><b>Profile</b></th><th colspan="1" valign="bottom"><b>Status</b></th><th colspan="1" valign="bottom"><b>Used for</b></th></tr>
<tr><td colspan="1" rowspan="2" valign="top"><b>ServiceRequest</b></td><td colspan="1" valign="top">lrc-referral</td><td colspan="1" valign="top">active</td><td colspan="1" rowspan="2" valign="top">רק משאבים בסטאטוס זה יטופלו על ידי הקהילה</td></tr>
<tr><td colspan="1" valign="top">lrc-referral-group</td><td colspan="1" valign="top">active</td></tr>
<tr><td colspan="1" rowspan="5" valign="top"><b>Observation</b></td><td colspan="1" rowspan="3" valign="top">lrc-result</td><td colspan="1" valign="top">final</td><td colspan="1" valign="top">ערך ברירת המחדל של התוצאה הבודדת</td></tr>
<tr><td colspan="1" valign="top">entered-in-error</td><td colspan="1" valign="top">עבור תוצאה לא תקינה, למשל בעקבות תקלה טכנית</td></tr>
<tr><td colspan="1" valign="top">cancelled</td><td colspan="1" valign="top">עבור ביטול תוצאה שכבר שודרה</td></tr>
<tr><td colspan="1" rowspan="2" valign="top">lrc-panel-result</td><td colspan="1" valign="top">final</td><td colspan="1" valign="top">עבור מאגד או סוללה לאחר קבלת כל התוצאות</td></tr>
<tr><td colspan="1" valign="top">preliminary</td><td colspan="1" valign="top">עבור מאגד או סוללה עם תוצאות חלקיות.</td></tr>
<tr><td colspan="1" rowspan="5" valign="top"><b>DiagnosticReport</b></td><td colspan="1" rowspan="5" valign="top">lrc-panel-report</td><td colspan="1" valign="top">registered</td><td colspan="1" valign="top">סטאטוס בעת יצירת הדוח המסכם</td></tr>
<tr><td colspan="1" valign="top">cancelled</td><td colspan="1" valign="top">במקרים של כשל בעיבוד (ביטול הטיפול בהפנייה)</td></tr>
<tr><td colspan="1" valign="top">partial</td><td colspan="1" valign="top">במקרים בהם הדוח המסכם עדיין לא הושלם</td></tr>
<tr><td colspan="1" valign="top">final</td><td colspan="1" valign="top">כאשר מתקבלות כל התוצאות במלואן</td></tr>
<tr><td colspan="1" valign="top">amended</td><td colspan="1" valign="top">כאשר נוספו בדיקות אשר לא נכללו בהפניה המאגדת</td></tr>
</table>

  <p>פירוט נוסף עבור כל סטאטוס, ניתן למצוא בפרופולים הרלוונטיים.</p>

</div>




</div>
        </div>  <!-- /inner-wrapper -->
      </div>  <!-- /row -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-content -->

  <script type="text/javascript" src="assets/js/jquery.js"> </script>     <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script type="text/javascript" src="assets/js/jquery-ui.min.js"> </script>

  <script type="text/javascript">
    $(document).ready(function(){
      if(window.location.hash != "") {
          $('a[href="' + window.location.hash + '"]').click()
      }
    });
  </script>
  <a name="bottom"> </a>
  <div id="segment-footer" igtool="footer" class="segment">  <!-- segment-footer -->
    <div class="container">  <!-- container -->

      <div class="inner-wrapper">
        <p>
          IG &#169; 2024+ <a style="color:var(--footer-hyperlink-text-color)" href="http://outburn.co.il">Outburn LTD.</a>.  Package lab-referral-cycle#0.1.0 based on <a style="color: var(--footer-hyperlink-text-color)" href="http://hl7.org/fhir/R4/">FHIR 4.0.1</a>. Generated <span title="Thu, Feb 22, 2024 18:05+0200">2024-02-22</span>
          <br/>
          <span style="color: var(--footer-highlight-text-color)">
                      Links: <a style="color: var(--footer-hyperlink-text-color)" href="toc.html">Table of Contents</a> |
                 <a style="color: var(--footer-hyperlink-text-color)" href="qa.html">QA Report</a>
                 
                
          </span>
        </p>
      </div>  <!-- /inner-wrapper -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">  <!-- segment-post-footer -->
    <div class="container">  <!-- container -->
    </div>  <!-- /container -->
  </div>  <!-- /segment-post-footer -->
  
  <!-- JS and analytics only. -->
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script type="text/javascript" src="assets/js/bootstrap.min.js"> </script>
  <script type="text/javascript" src="assets/js/respond.min.js"> </script>
  <script type="text/javascript" src="assets/js/anchor.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard.min.js"> </script>
  <script type="text/javascript" src="assets/js/clipboard-btn.js"> </script>
  <script>anchors.options.visible = 'hover'
anchors.add()</script>
  
<!-- feedback form - Google forms -->
<!-- v0.1, 2021-01-09 -->



<!-- / feedback form  -->

  <!-- Analytics Below
  ================================================== -->
  </body>
</html>

